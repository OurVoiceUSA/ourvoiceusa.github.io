(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{209:function(e,t,a){e.exports=a(462)},214:function(e,t,a){},462:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(38),o=a.n(s),c=(a(214),a(5)),i=a.n(c),l=a(13),u=a(19),m=a(20),p=a(23),d=a(21),h=a(22),f=a(10),v=a(469),b=a(466),g=a(467),E=a(16),O=a.n(E),w=a(99),y=a.n(w),j=a(185),k=a.n(j),S=a(100),x=a.n(S),T=a(186),C=a(18),A=a(187),F=a.n(A),N=a(129),D=a(188),_=a.n(D);N.a.locale(_.a);var M={AL:"Alabama",AK:"Alaska",AS:"American Samoa",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",DC:"District Of Columbia",FM:"Federated States Of Micronesia",FL:"Florida",GA:"Georgia",GU:"Guam",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MH:"Marshall Islands",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",MP:"Northern Mariana Islands",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PW:"Palau",PA:"Pennsylvania",PR:"Puerto Rico",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VI:"Virgin Islands",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"};var I=function(e){return r.a.createElement("div",Object.assign({style:{display:"flex"}},e))},P=function(e){return r.a.createElement("div",Object.assign({style:{width:"22vw",height:"100vh",overlow:"auto",background:"#eee"}},e))},V=function(e){return r.a.createElement("div",Object.assign({style:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",padding:"5px 10px"}},e))},B=function(e){return r.a.createElement("div",{style:{flex:1,height:"100vh",overflow:"auto"}},r.a.createElement("div",Object.assign({style:{padding:"20px"}},e)))},z=function(e){return r.a.createElement(T.a,Object.assign({style:{width:25}},e))},H=function(e){return r.a.createElement(x.a,Object.assign({type:"ThreeDots"},e))},U=function(e){return e.flag?r.a.createElement(H,null):r.a.createElement("div",null,r.a.createElement(z,{icon:C.m,color:"green",onClick:e.func}),r.a.createElement("div",null,e.children))},J=function(e){var t=new N.a("en-US");return r.a.createElement("div",{style:{display:"flex",padding:"10px"}},r.a.createElement("div",{style:{padding:"5px 10px"}},r.a.createElement(F.a,{width:50,src:e.canvasser.avatar,loader:r.a.createElement(H,{width:50}),unloader:r.a.createElement(z,{style:{width:50,height:50,color:"gray"},icon:C.o})})),r.a.createElement("div",{style:{flex:1,overflow:"auto"}},"Name: ",e.canvasser.name," ",e.edit?"":r.a.createElement(b.a,{to:"/canvassers/"+e.canvasser.id,onClick:function(){return e.refer.setState({thisCanvasser:e.canvasser})}},"view profile")," ",e.canvasser.admin?r.a.createElement(z,{icon:C.f,color:"gold"}):"",r.a.createElement("br",null),"Location: ",e.canvasser.location?e.canvasser.location:"N/A"," ",r.a.createElement("br",null),"Last Login: ",t.format(new Date(e.canvasser.last_seen-3e4))),r.a.createElement("br",null),e.edit&&e.canvasser.locked?r.a.createElement("button",{onClick:function(){return e.refer._lockCanvasser(e.canvasser,!1)}},"Restore Access"):"",e.edit&&!e.canvasser.locked?r.a.createElement("button",{onClick:function(){return e.refer._lockCanvasser(e.canvasser,!0)}},"Deny Access"):"")};function L(e,t){return W.apply(this,arguments)}function W(){return(W=Object(l.a)(i.a.mark(function e(t,a){var n,r,s,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],t.setState({loading:!0}),e.prev=2,r="canvasser/list",a&&(r="team/members/list?teamName="+a),e.next=7,fetch("https://"+t.props.server+"/canvass/v1/"+r,{headers:{Authorization:"Bearer "+(t.props.jwt?t.props.jwt:"of the one ring"),"Content-Type":"application/json"}});case 7:return s=e.sent,e.next=10,s.json();case 10:o=e.sent,n=o.data?o.data:[],e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),console.warn(e.t0);case 17:return t.setState({loading:!1}),e.abrupt("return",n);case 19:case"end":return e.stop()}},e,this,[[2,14]])}))).apply(this,arguments)}var R=function(e){return r.a.createElement("div",null,r.a.createElement(z,{icon:C.l})," ",e.turf.name," (",r.a.createElement(b.a,{to:"/turf/view/"+e.turf.name,onClick:function(){e.refer.setState({thisTurf:e.turf})}},"view"),")",r.a.createElement("br",null),r.a.createElement("hr",null))};function K(e,t){return Y.apply(this,arguments)}function Y(){return(Y=Object(l.a)(i.a.mark(function e(t,a){var n,r,s,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],t.setState({loading:!0}),e.prev=2,r="turf/list",a&&(r="team/turf/list?teamName="+a),e.next=7,fetch("https://"+t.props.server+"/canvass/v1/"+r,{headers:{Authorization:"Bearer "+(t.props.jwt?t.props.jwt:"of the one ring"),"Content-Type":"application/json"}});case 7:return s=e.sent,e.next=10,s.json();case 10:o=e.sent,n=o.data?o.data:[],e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),console.warn(e.t0);case 17:return t.setState({loading:!1}),e.abrupt("return",n);case 19:case"end":return e.stop()}},e,this,[[2,14]])}))).apply(this,arguments)}var G=function(e){return r.a.createElement("div",null,r.a.createElement(z,{icon:C.c})," ",e.form.name," (",r.a.createElement(b.a,{to:"/forms/edit/"+e.form.id,onClick:function(){e.refer.setState({thisForm:e.form})}},"view"),")",r.a.createElement("br",null),r.a.createElement("hr",null))};function q(e,t){return X.apply(this,arguments)}function X(){return(X=Object(l.a)(i.a.mark(function e(t,a){var n,r,s,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],t.setState({loading:!0}),e.prev=2,r=a?"team/form/list?teamName="+a:"form/list",e.next=6,fetch("https://"+t.props.server+"/canvass/v1/"+r,{headers:{Authorization:"Bearer "+(t.props.jwt?t.props.jwt:"of the one ring"),"Content-Type":"application/json"}});case 6:return s=e.sent,e.next=9,s.json();case 9:o=e.sent,n=o.data?o.data:[],e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),console.warn(e.t0);case 16:return t.setState({loading:!1}),e.abrupt("return",n);case 18:case"end":return e.stop()}},e,this,[[2,13]])}))).apply(this,arguments)}function Z(e){return $.apply(this,arguments)}function $(){return($=Object(l.a)(i.a.mark(function e(t){var a,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={},e.prev=1,e.next=4,fetch("https://"+t.props.server+"/canvass/v1/sync",{method:"POST",headers:{Authorization:"Bearer "+(t.props.jwt?t.props.jwt:"of the one ring"),"Content-Type":"application/json"},body:JSON.stringify({nodes:{}})});case 4:return n=e.sent,e.next=7,n.json();case 7:a=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.warn(e.t0);case 13:return e.abrupt("return",a);case 14:case"end":return e.stop()}},e,this,[[1,10]])}))).apply(this,arguments)}var Q=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e)))._loadData=Object(l.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},a.setState({loading:!0}),e.prev=2,e.next=5,fetch("https://"+a.props.server+"/canvass/v1/dashboard",{headers:{Authorization:"Bearer "+(a.props.jwt?a.props.jwt:"of the one ring"),"Content-Type":"application/json"}});case 5:return n=e.sent,e.next=8,n.json();case 8:t=e.sent,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.warn(e.t0);case 14:a.setState({data:t,loading:!1});case 15:case"end":return e.stop()}},e,this,[[2,11]])})),a.state={loading:!0},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this._loadData()}},{key:"render",value:function(){return r.a.createElement(U,{flag:this.state.loading,func:this._loadData},JSON.stringify(this.state.data))}}]),t}(n.Component),ee=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e))).componentDidMount=Object(l.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a._loadCanvassers();case 1:case"end":return e.stop()}},e,this)})),a._loadCanvassers=Object(l.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a,e.next=3,L(Object(f.a)(Object(f.a)(a)));case 3:e.t1=e.sent,e.t2={canvassers:e.t1},e.t0.setState.call(e.t0,e.t2);case 6:case"end":return e.stop()}},e,this)})),a._lockCanvasser=function(){var e=Object(l.a)(i.a.mark(function e(t,n){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://"+a.props.server+"/canvass/v1/canvasser/"+(n?"lock":"unlock"),{method:"POST",headers:{Authorization:"Bearer "+(a.props.jwt?a.props.jwt:"of the one ring"),"Content-Type":"application/json"},body:JSON.stringify({id:t.id})});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.warn(e.t0);case 8:a._loadCanvassers(),window.location.href="/HelloVoter/#/canvassers/";case 10:case"end":return e.stop()}},e,this,[[0,5]])}));return function(t,a){return e.apply(this,arguments)}}(),a._loadSingle=Object(l.a)(i.a.mark(function e(){var t,n,r,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},a.setState({loading:!0}),e.prev=2,n=a.props.location.pathname.split("/").pop(),e.next=6,fetch("https://"+a.props.server+"/canvass/v1/canvasser/get?id="+n,{headers:{Authorization:"Bearer "+(a.props.jwt?a.props.jwt:"of the one ring"),"Content-Type":"application/json"}});case 6:return r=e.sent,e.next=9,r.json();case 9:s=e.sent,t=s.data?s.data:{},e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),console.warn(e.t0);case 16:a.setState({loading:!1,thisCanvasser:t});case 17:case"end":return e.stop()}},e,this,[[2,13]])})),a.state={loading:!0,canvassers:[],thisCanvasser:{}},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=[],a=[];return this.state.canvassers.forEach(function(n){n.locked?a.push(r.a.createElement(J,{key:n.id,canvasser:n,refer:e})):t.push(r.a.createElement(J,{key:n.id,canvasser:n,refer:e}))}),r.a.createElement(v.a,null,r.a.createElement("div",null,r.a.createElement(g.a,{exact:!0,path:"/canvassers/",render:function(){return r.a.createElement(U,{flag:e.state.loading,func:function(){return e._loadCanvassers()}},r.a.createElement("h3",null,"Canvassers:"),t,a.length?r.a.createElement("div",null,r.a.createElement("h3",null,"Denied access:"),a):"")}}),r.a.createElement(g.a,{path:"/canvassers/:id",render:function(t){return r.a.createElement(U,{flag:e.state.loading,func:e._loadSingle},r.a.createElement(J,{key:e.state.thisCanvasser.id,canvasser:e.state.thisCanvasser,edit:!0,refer:e}),r.a.createElement("br",null),"Email: ",e.state.thisCanvasser.email?e.state.thisCanvasser.email:"N/A",r.a.createElement("br",null),"Phone: ",e.state.thisCanvasser.phone?e.state.thisCanvasser.phone:"N/A",r.a.createElement("br",null),"# of doors knocked: 0")}})))}}]),t}(n.Component),te=a(52),ae=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e))).handleMembersChange=function(e){a.setState({selectedMembersOption:e})},a.handleTurfChange=function(e){a.setState({selectedTurfOption:e})},a.handleFormChange=function(e){a.setState({selectedFormOption:e})},a._saveTeam=Object(l.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({saving:!0}),e.prev=1,e.next=4,fetch("https://"+a.props.server+"/canvass/v1/team/members/wipe",{method:"POST",headers:{Authorization:"Bearer "+(a.props.jwt?a.props.jwt:"of the one ring"),"Content-Type":"application/json"},body:JSON.stringify({teamName:a.state.thisTeam})});case 4:return e.next=6,fetch("https://"+a.props.server+"/canvass/v1/team/turf/wipe",{method:"POST",headers:{Authorization:"Bearer "+(a.props.jwt?a.props.jwt:"of the one ring"),"Content-Type":"application/json"},body:JSON.stringify({teamName:a.state.thisTeam})});case 6:return e.next=8,fetch("https://"+a.props.server+"/canvass/v1/team/form/wipe",{method:"POST",headers:{Authorization:"Bearer "+(a.props.jwt?a.props.jwt:"of the one ring"),"Content-Type":"application/json"},body:JSON.stringify({teamName:a.state.thisTeam})});case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.warn(e.t0);case 13:return a.state.selectedMembersOption.map(function(){var e=Object(l.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://"+a.props.server+"/canvass/v1/team/members/add",{method:"POST",headers:{Authorization:"Bearer "+(a.props.jwt?a.props.jwt:"of the one ring"),"Content-Type":"application/json"},body:JSON.stringify({teamName:a.state.thisTeam,cId:t.id})});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.warn(e.t0);case 8:case"end":return e.stop()}},e,this,[[0,5]])}));return function(t){return e.apply(this,arguments)}}()),e.prev=14,e.next=17,fetch("https://"+a.props.server+"/canvass/v1/team/turf/add",{method:"POST",headers:{Authorization:"Bearer "+(a.props.jwt?a.props.jwt:"of the one ring"),"Content-Type":"application/json"},body:JSON.stringify({teamName:a.state.thisTeam,turfName:a.state.selectedTurfOption.value})});case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(14),console.warn(e.t1);case 22:return e.prev=22,e.next=25,fetch("https://"+a.props.server+"/canvass/v1/team/form/add",{method:"POST",headers:{Authorization:"Bearer "+(a.props.jwt?a.props.jwt:"of the one ring"),"Content-Type":"application/json"},body:JSON.stringify({teamName:a.state.thisTeam,fId:a.state.selectedFormOption.value})});case 25:e.next=30;break;case 27:e.prev=27,e.t2=e.catch(22),console.warn(e.t2);case 30:a.setState({saving:!1});case 31:case"end":return e.stop()}},e,this,[[1,10],[14,19],[22,27]])})),a._deleteTeam=Object(l.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://"+a.props.server+"/canvass/v1/team/delete",{method:"POST",headers:{Authorization:"Bearer "+(a.props.jwt?a.props.jwt:"of the one ring"),"Content-Type":"application/json"},body:JSON.stringify({name:a.state.thisTeam})});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.warn(e.t0);case 8:window.location.href="/HelloVoter/#/teams/",a._loadTeams();case 10:case"end":return e.stop()}},e,this,[[0,5]])})),a._createTeam=Object(l.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=a.addTeamForm.getValue())){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,fetch("https://"+a.props.server+"/canvass/v1/team/create",{method:"POST",headers:{Authorization:"Bearer "+(a.props.jwt?a.props.jwt:"of the one ring"),"Content-Type":"application/json"},body:JSON.stringify({name:t.name})});case 5:window.location.href="/HelloVoter/#/teams/",a._loadTeams();case 7:case"end":return e.stop()}},e,this)})),a._loadTeams=Object(l.a)(i.a.mark(function e(){var t,n,s,o,c,l,u,m;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},a.setState({loading:!0}),e.prev=2,e.next=5,fetch("https://"+a.props.server+"/canvass/v1/team/list",{headers:{Authorization:"Bearer "+(a.props.jwt?a.props.jwt:"of the one ring"),"Content-Type":"application/json"}});case 5:return n=e.sent,e.next=8,n.json();case 8:t=e.sent,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.warn(e.t0);case 14:return a.setState({teams:t.data}),e.next=17,L(Object(f.a)(Object(f.a)(a)));case 17:return s=e.sent,e.next=20,K(Object(f.a)(Object(f.a)(a)));case 20:return o=e.sent,e.next=23,q(Object(f.a)(Object(f.a)(a)));case 23:c=e.sent,l=[],u=[],m=[],s.forEach(function(e){l.push({value:e.name+e.email+e.location+(e.admin?"admin":""),id:e.id,label:r.a.createElement(J,{key:e.id,canvasser:e,refer:Object(f.a)(Object(f.a)(a))})})}),o.forEach(function(e){u.push({value:e.name,label:r.a.createElement(R,{key:e.name,turf:e})})}),c.forEach(function(e){m.push({value:e.id,label:r.a.createElement(G,{key:e.id,form:e})})}),a.setState({memberOptions:l,turfOptions:u,formOptions:m});case 31:case"end":return e.stop()}},e,this,[[2,11]])})),a.state={loading:!0,saving:!1,selectedMembersOption:null,selectedTurfOption:null,selectedFormOption:null,teams:[],thisTeam:null},a.formServerItems=O.a.struct({name:O.a.String}),a.formServerOptions={fields:{server:{label:"Team Name",error:"You must enter a team name."}}},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"onChangeTeam",value:function(e){this.setState({addTeamForm:e})}},{key:"componentDidMount",value:function(){this._loadTeams()}},{key:"render",value:function(){var e=this;return r.a.createElement(v.a,null,r.a.createElement("div",null,r.a.createElement(g.a,{exact:!0,path:"/teams/",render:function(){return r.a.createElement(U,{flag:e.state.loading,func:e._loadTeams},e.state.loading?"loading":e.state.teams.map(function(t){return r.a.createElement(ne,{key:t.name,team:t,refer:e})}),r.a.createElement(b.a,{to:"/teams/add"},r.a.createElement("button",null,"Add Team")))}}),r.a.createElement(g.a,{exact:!0,path:"/teams/add",render:function(){return r.a.createElement("div",null,r.a.createElement(O.a.form.Form,{ref:function(t){return e.addTeamForm=t},type:e.formServerItems,options:e.formServerOptions,onChange:function(t){return e.onChangeTeam(t)},value:e.state.addTeamForm}),r.a.createElement("button",{onClick:function(){return e._createTeam()}},"Submit"))}}),r.a.createElement(g.a,{path:"/teams/edit/:name",render:function(){return r.a.createElement("div",null,r.a.createElement("h3",null,e.state.thisTeam),"Canvassers:",r.a.createElement(te.a,{value:e.state.selectedMembersOption,onChange:e.handleMembersChange,options:e.state.memberOptions,isMulti:!0,isSearchable:!0,placeholder:"Select team members to add"}),r.a.createElement("br",null),"Turf:",r.a.createElement(te.a,{value:e.state.selectedTurfOption,onChange:e.handleTurfChange,options:e.state.turfOptions,isSearchable:!0,placeholder:"Select turf for this team"}),r.a.createElement("br",null),"Form:",r.a.createElement(te.a,{value:e.state.selectedFormOption,onChange:e.handleFormChange,options:e.state.formOptions,isSearchable:!0,placeholder:"Select form for this team"}),r.a.createElement("br",null),e.state.saving?r.a.createElement(H,null):r.a.createElement("button",{onClick:function(){return e._saveTeam()}},"Save Team"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("button",{onClick:function(){return e._deleteTeam()}},"Delete Team"))}})))}}]),t}(n.Component),ne=function(e){return r.a.createElement("div",{style:{display:"flex",padding:"10px"}},r.a.createElement("div",{style:{padding:"5px 10px"}},r.a.createElement(z,{style:{width:35,height:35,color:"gray"},icon:C.p})),r.a.createElement("div",{style:{flex:1,overflow:"auto"}},e.team.name," (",r.a.createElement(b.a,{to:"/teams/edit/"+e.team.name,onClick:Object(l.a)(i.a.mark(function t(){var a,n,s,o,c;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.refer.setState({thisTeam:e.team.name,selectedMembersOption:null,selectedTurfOption:null,selectedFormOption:null}),a=[],n={},s={},t.prev=4,t.next=7,L(e.refer,e.team.name);case 7:t.sent.forEach(function(t){a.push({value:t.name+t.email+t.location,id:t.id,label:r.a.createElement(J,{key:t.id,canvasser:t,refer:e.refer})})}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(4),console.warn(t.t0);case 14:return t.prev=14,t.next=17,K(e.refer,e.team.name);case 17:o=t.sent,n={value:o[0].name,label:r.a.createElement(R,{key:o[0].name,turf:o[0]})},t.next=24;break;case 21:t.prev=21,t.t1=t.catch(14),console.warn(t.t1);case 24:return t.prev=24,t.next=27,q(e.refer,e.team.name);case 27:c=t.sent,s={value:c[0].id,label:r.a.createElement(G,{key:c[0].id,form:c[0]})},t.next=34;break;case 31:t.prev=31,t.t2=t.catch(24),console.warn(t.t2);case 34:e.refer.setState({selectedMembersOption:a,selectedTurfOption:n,selectedFormOption:s});case 35:case"end":return t.stop()}},t,this,[[4,11],[14,21],[24,31]])}))},"edit"),")"))},re=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e))).handleDrawChange=function(e){a.setState({selectedDrawOption:e})},a.handleStateChange=function(e){a.setState({selectedStateOption:e})},a.handleTypeChange=function(e){a.setState({selectedTypeOption:e})},a.handleDistrictChange=function(e){a.setState({selectedDistrictOption:e})},a._deleteTurf=Object(l.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://"+a.props.server+"/canvass/v1/turf/delete",{method:"POST",headers:{Authorization:"Bearer "+(a.props.jwt?a.props.jwt:"of the one ring"),"Content-Type":"application/json"},body:JSON.stringify({name:a.state.thisTurf.name})});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.warn(e.t0);case 8:a._loadTurf(Object(f.a)(Object(f.a)(a))),window.location.href="/HelloVoter/#/turf/";case 10:case"end":return e.stop()}},e,this,[[0,5]])})),a._createTurf=Object(l.a)(i.a.mark(function e(){var t,n,r,s,o,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=a.addTurfForm.getValue())){e.next=3;break}return e.abrupt("return");case 3:a.setState({saving:!0}),r=a.state.selectedStateOption.value,e.t0=a.state.selectedTypeOption.value,e.next="state"===e.t0?8:"cd"===e.t0?10:"sldu"===e.t0?12:"sldl"===e.t0?14:16;break;case 8:return n="states/"+r+"/shape.geojson",e.abrupt("break",17);case 10:return n="cds/2016/"+a.state.selectedDistrictOption.value+"/shape.geojson",e.abrupt("break",17);case 12:return n="states/"+r+"/sldu/"+a.state.selectedDistrictOption.value+".geojson",e.abrupt("break",17);case 14:return n="states/"+r+"/sldl/"+a.state.selectedDistrictOption.value+".geojson",e.abrupt("break",17);case 16:throw new Error("unknown selectedTypeOption");case 17:return e.prev=17,e.next=20,fetch("https://raw.githubusercontent.com/OurVoiceUSA/districts/gh-pages/"+n);case 20:return s=e.sent,e.next=23,s.json();case 23:return o=e.sent,c=o.geometry?o.geometry:o,e.next=27,fetch("https://"+a.props.server+"/canvass/v1/turf/create",{method:"POST",headers:{Authorization:"Bearer "+(a.props.jwt?a.props.jwt:"of the one ring"),"Content-Type":"application/json"},body:JSON.stringify({name:t.name,geometry:c})});case 27:s=e.sent,e.next=33;break;case 30:e.prev=30,e.t1=e.catch(17),console.warn(e.t1);case 33:a.setState({saving:!1}),window.location.href="/HelloVoter/#/turf/",a._loadTurf();case 36:case"end":return e.stop()}},e,this,[[17,30]])})),a.selectedTypeFetch=Object(l.a)(i.a.mark(function e(){var t,n,r,s,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.state.selectedTypeOption){e.next=2;break}return e.abrupt("return");case 2:a.setState({districtOptions:[]}),n=a.state.selectedStateOption.value,e.t0=a.state.selectedTypeOption.value,e.next="cd"===e.t0?7:"sldu"===e.t0?9:"sldl"===e.t0?11:13;break;case 7:return t="cds/2016/",e.abrupt("break",14);case 9:return t="states/"+n+"/sldu/",e.abrupt("break",14);case 11:return t="states/"+n+"/sldl/",e.abrupt("break",14);case 13:return e.abrupt("return");case 14:return e.next=16,fetch("https://api.github.com/repos/OurVoiceUSA/districts/contents/"+t);case 16:return r=e.sent,s=[],e.next=20,r.json();case 20:o=e.sent,e.t1=a.state.selectedTypeOption.value,e.next="cd"===e.t1?24:26;break;case 24:return o.forEach(function(e){e.name.includes(a.state.selectedStateOption.value)&&s.push({value:e.name,label:e.name})}),e.abrupt("break",27);case 26:o.forEach(function(e){var t=e.name.replace(".geojson","");s.push({value:t,label:t})});case 27:a.setState({districtOptions:s});case 28:case"end":return e.stop()}},e,this)})),a._loadTurf=Object(l.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loading:!0}),e.next=3,K(Object(f.a)(Object(f.a)(a)));case 3:t=e.sent,a.setState({loading:!1,turf:t});case 5:case"end":return e.stop()}},e,this)})),a.state={loading:!0,saving:!1,selectedDrawOption:null,selectedStateOption:null,selectedTypeOption:null,selectedDistrictOption:null,districtOptions:[],turf:[],thisTurf:{}},a.formServerItems=O.a.struct({name:O.a.String}),a.formServerOptions={fields:{server:{label:"Turf Name",error:"You must enter a turf name."}}},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"onChangeTurf",value:function(e){this.setState({addTurfForm:e})}},{key:"_showDistrictOption",value:function(){if(!this.state.selectedTypeOption)return!1;switch(this.state.selectedTypeOption.value){case"cd":case"sldu":case"sldl":return!0;default:return!1}}},{key:"_showSubmitButton",value:function(){return!(!this.state.selectedTypeOption||this._showDistrictOption())||!(!this._showDistrictOption()||!this.state.selectedDistrictOption)}},{key:"componentDidMount",value:function(){this._loadTurf()}},{key:"render",value:function(){var e=this,t=[{value:"select",label:"Select from legislative boundary"},{value:"radius",label:"Area surrounding an address"},{value:"draw",label:"Manually draw with your mouse"}],a=[],n=[{value:"state",label:"State"},{value:"cd",label:"Congressional"},{value:"sldu",label:"State Senate"},{value:"sldl",label:"State House"}];return Object.keys(M).map(function(e){return a.push({value:e,label:M[e]})}),r.a.createElement(v.a,null,r.a.createElement("div",null,r.a.createElement(g.a,{exact:!0,path:"/turf/",render:function(){return r.a.createElement(U,{flag:e.state.loading,func:e._loadTurf},e.state.loading?"loading":e.state.turf.map(function(t){return r.a.createElement(R,{key:t.name,turf:t,refer:e})}),r.a.createElement(b.a,{to:"/turf/add"},r.a.createElement("button",null,"Add Turf")))}}),r.a.createElement(g.a,{exact:!0,path:"/turf/add",render:function(){return r.a.createElement("div",null,"Turf Name:",r.a.createElement(O.a.form.Form,{ref:function(t){return e.addTurfForm=t},type:e.formServerItems,options:e.formServerOptions,onChange:function(t){return e.onChangeTurf(t)},value:e.state.addTurfForm}),r.a.createElement("br",null),"Method of generating turf:",r.a.createElement(te.a,{value:e.state.selectedDrawOption,onChange:e.handleDrawChange,options:t,placeholder:"Select method"}),e.state.selectedDrawOption&&"select"===e.state.selectedDrawOption.value?r.a.createElement("div",null,r.a.createElement("br",null),"State or region:",r.a.createElement(te.a,{value:e.state.selectedStateOption,onChange:e.handleStateChange,options:a,isSearchable:!0,placeholder:"Select state or region"})):e.state.selectedDrawOption?"This method is not currently available.":"",e.state.selectedStateOption?r.a.createElement("div",null,r.a.createElement("br",null),"District Type:",r.a.createElement(te.a,{value:e.state.selectedTypeOption,onChange:e.handleTypeChange,onMenuClose:e.selectedTypeFetch,options:n,isSearchable:!0,placeholder:"Select district for this turf"})):"",e._showDistrictOption()?r.a.createElement("div",null,r.a.createElement("br",null),"District Number:",e.state.districtOptions.length?r.a.createElement(te.a,{value:e.state.selectedDistrictOption,onChange:e.handleDistrictChange,options:e.state.districtOptions,isSearchable:!0,placeholder:"Select district for this turf"}):r.a.createElement(H,null)):"",e._showSubmitButton()?r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("button",{onClick:function(){return e._createTurf()}},"Submit")):"")}}),r.a.createElement(g.a,{path:"/turf/view/:name",render:function(){return r.a.createElement("div",null,r.a.createElement("h3",null,e.state.thisTurf.name),e.state.thisTurf.geometry,r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("button",{onClick:function(){return e._deleteTurf()}},"Delete Turf"))}})))}}]),t}(n.Component),se=a(130),oe=a.n(se);oe.a.setAppElement(document.getElementById("root"));var ce={content:{top:"15%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}},ie=O.a.enums({String:"Text Input",TEXTBOX:"Large Text Box",Number:"Number",Boolean:"On/Off Switch",SAND:"Agree/Disagree"},"FTYPE"),le={key:O.a.String,label:O.a.String,type:ie},ue={fields:{key:{label:"Input Key",help:"The spreadsheet column name."},label:{label:"Input Label",help:"Label the user sees on the form."},type:{help:"The type of input the user can enter."}}},me={FullName:{label:"Full Name",type:"String",optional:!0},Phone:{label:"Phone Number",type:"Number",optional:!0},Email:{label:"Email Address",type:"String",optional:!0},RegisteredToVote:{label:"Are you registered to vote?",type:"Boolean",optional:!0},PartyAffiliation:{label:"Party Affiliation",type:"List",optional:!0,options:["No Party Preference","Democratic","Republican","Green","Libertarian","Other"]}},pe=function(e){function t(e){var a;Object(u.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e)))._loadForms=Object(l.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a,e.next=3,q(Object(f.a)(Object(f.a)(a)));case 3:e.t1=e.sent,e.t2={forms:e.t1},e.t0.setState.call(e.t0,e.t2);case 6:case"end":return e.stop()}},e,this)})),a._createForm=Object(l.a)(i.a.mark(function e(){var t,n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=a.addFormForm.getValue())){e.next=3;break}return e.abrupt("return");case 3:if(a.setState({saving:!0}),(n=t.name.trim()).match(/^[a-zA-Z0-9\-_ ]+$/)){e.next=8;break}return console.warn("From name can only contain alphanumeric characters, and spaces and dashes."),e.abrupt("return");case 8:if(!(n.length>255)){e.next=11;break}return console.warn("Form name cannot be longer than 255 characters."),e.abrupt("return");case 11:return e.prev=11,r={name:n,questions:a.state.fields,questions_order:a.state.order},e.next=15,fetch("https://"+a.props.server+"/canvass/v1/form/create",{method:"POST",headers:{Authorization:"Bearer "+(a.props.jwt?a.props.jwt:"of the one ring"),"Content-Type":"application/json"},body:JSON.stringify(r)});case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(11),console.warn(e.t0);case 20:a.setState({saving:!1}),window.location.href="/HelloVoter/#/forms/",a._loadForms();case 23:case"end":return e.stop()}},e,this,[[11,17]])}));var n=JSON.parse(JSON.stringify(me)),r=Object.keys(n);return a.mainForm=O.a.struct({name:O.a.String}),a.state={loading:!0,forms:[],thisForm:{},fields:n,order:r,customForm:null},a.formServerItems=O.a.struct({name:O.a.String}),a.customFormItems=O.a.struct(le),a.formServerOptions={fields:{name:{label:"Form Name",error:"You must enter a form name."}}},a.onChange=a.onChange.bind(Object(f.a)(Object(f.a)(a))),a.openModal=a.openModal.bind(Object(f.a)(Object(f.a)(a))),a.closeModal=a.closeModal.bind(Object(f.a)(Object(f.a)(a))),a.doAddCustom=a.doAddCustom.bind(Object(f.a)(Object(f.a)(a))),a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"openModal",value:function(){this.setState({customForm:O.a.struct(le)})}},{key:"closeModal",value:function(){this.setState({customForm:null})}},{key:"doAddCustom",value:function(){var e=this.state,t=e.fields,a=e.order,n=this.customForm.getValue();if(null!==n){var r=JSON.parse(JSON.stringify(n)),s=r.key;delete r.key,r.optional=!0,t[s]?console.warn("Duplicate"):(t[s]=r,a[a.length]=s,this.setState({customForm:null,fields:t,order:a}))}}},{key:"doShowCustom",value:function(){this.setState({customForm:O.a.struct(le)})}},{key:"inputTypeToReadable",value:function(e){switch(e){case"String":return"Text Input";case"TEXTBOX":return"Text Box";case"Number":return"Number";case"Boolean":return"On/Off Switch";case"SAND":return"Agree/Disagree";case"List":return"Select from List";default:return e}}},{key:"rmField",value:function(e){var t=this.state,a=t.fields,n=t.order;for(var r in a)a[r]===e&&(delete a[r],n.splice(n.indexOf(r),1));this.setState({fields:a,order:n}),this.forceUpdate()}},{key:"onChange",value:function(e){"List"===e.type&&(e=O.a.String)}},{key:"onChangeForm",value:function(e){this.setState({addFormForm:e})}},{key:"componentDidMount",value:function(){this._loadForms()}},{key:"render",value:function(){var e=this;return r.a.createElement(v.a,null,r.a.createElement("div",null,r.a.createElement(g.a,{exact:!0,path:"/forms/",render:function(){return r.a.createElement(U,{flag:e.state.loading,func:function(){return e._loadForms()}},e.state.forms.map(function(t){return r.a.createElement(G,{key:t.id,form:t,refer:e})}),r.a.createElement(b.a,{to:"/forms/add"},r.a.createElement("button",null,"Add Form")))}}),r.a.createElement(g.a,{path:"/forms/add",render:function(t){return r.a.createElement("div",null,r.a.createElement(O.a.form.Form,{ref:function(t){return e.addFormForm=t},type:e.formServerItems,options:e.formServerOptions,onChange:function(t){return e.onChangeForm(t)},value:e.state.addFormForm}),r.a.createElement("div",{style:{margin:25}},"Items in your Canvassing form: ",r.a.createElement("button",{onClick:e.openModal},r.a.createElement(z,{icon:C.j})," Add Item")),Object.keys(e.state.fields).map(function(t){var a=e.state.fields[t];return r.a.createElement("li",{key:t,style:{marginLeft:25}},a.label+(a.required?" *":"")," : ",e.inputTypeToReadable(a.type)," ",r.a.createElement(z,{icon:C.n,color:"red"}))}),e.state.saving?r.a.createElement(H,null):r.a.createElement("button",{style:{margin:25},onClick:function(){return e._createForm()}},"Create Form"),r.a.createElement(oe.a,{isOpen:null!==e.state.customForm,onAfterOpen:e.afterOpenModal,onRequestClose:e.closeModal,style:ce,contentLabel:"Add item to form"},r.a.createElement(O.a.form.Form,{ref:function(t){return e.customForm=t},type:e.customFormItems,options:ue,onChange:e.onChange,value:e.state.customForm}),r.a.createElement("button",{onClick:e.doAddCustom},"Add this item"),"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0",r.a.createElement("button",{onClick:function(){return e.setState({customForm:null})}},"Dismiss")))}}),r.a.createElement(g.a,{path:"/forms/edit/:id",render:function(t){return r.a.createElement(G,{key:e.state.thisForm.id,form:e.state.thisForm,refer:e})}})))}}]),t}(n.Component),de=a(67),he=a(192),fe=a(193),ve=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e)))._loadData=Object(l.a)(i.a.mark(function e(){var t,n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,K(Object(f.a)(Object(f.a)(a)));case 3:return n=e.sent,e.next=6,Z(Object(f.a)(Object(f.a)(a)));case 6:(r=e.sent.nodes)||(r={}),Object.keys(r).forEach(function(e){r[e]&&"address"===r[e].type&&t.push(r[e])}),a.setState({turfs:n,addresses:t});case 10:case"end":return e.stop()}},e,this)})),a.onMarkerClick=function(e,t,n){a.setState({selectedPlace:e,activeMarker:t,showingInfoWindow:!0})},a.onMapClicked=function(e){a.state.showingInfoWindow&&a.setState({showingInfoWindow:!1,activeMarker:null})},a.state={turfs:[],addresses:[],showingInfoWindow:!1,selectedPlace:{}},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this._loadData()}},{key:"render",value:function(){var e,t=this,a=[],n=this.state.addresses,s=(e=this.props).isGeolocationAvailable&&e.isGeolocationEnabled?e.coords?{access:!0,lng:e.coords.longitude,lat:e.coords.latitude}:{access:!0}:{access:!1};return this.state.turfs.forEach(function(e){Object(he.geojson2polygons)(JSON.parse(e.geometry)).forEach(function(e){return a.push(e)})}),r.a.createElement(de.Map,{google:this.props.google,zoom:14,center:s,onClick:this.onMapClicked},n.map(function(e,a){return r.a.createElement(de.Marker,{key:a,onClick:t.onMarkerClick,title:e.address.join(" "),position:{lat:e.latlng.latitude,lng:e.latlng.longitude}})}),a.map(function(e,t){return r.a.createElement(de.Polygon,{key:t,paths:e,strokeColor:"#0000FF",strokeWeight:5,fillColor:"#000000",fillOpacity:0})}),r.a.createElement(de.InfoWindow,{marker:this.state.activeMarker,visible:this.state.showingInfoWindow},r.a.createElement("div",null,r.a.createElement("h1",null,this.state.selectedPlace.title))))}}]),t}(n.Component),be=Object(de.GoogleApiWrapper)(function(e){return{apiKey:e.apiKey}})(Object(fe.geolocated)({positionOptions:{enableHighAccuracy:!1},userDecisionTimeout:5e3})(ve)),ge=a(194),Ee=a.n(ge),Oe=O.a.enums({address1:"Address 1",address2:"Address 2",city:"City",state:"State",zip:"Zip Code"},"HEADER"),we=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e))).preProcess=function(){var e=Object(l.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.shift(),t.pop(),a.setState({data:t,headers:n});case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.onHeadersSubmit=function(e){e.preventDefault(),a.setState({loading:!0}),setTimeout(function(){return a.setState({loading:!1,headers:[]})},3e3)},a.state={loading:!1,data:null,headers:[]},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"preProcessError",value:function(e){console.warn("BOOO = "+e)}},{key:"render",value:function(){if(this.state.loading)return r.a.createElement(H,null);if(this.state.headers.length){var e={},t={fields:{}};for(var a in this.state.headers)e[a]=O.a.maybe(Oe),t.fields[a]={label:this.state.headers[a]};var n=O.a.struct(e);return r.a.createElement("div",null,"Assign each header to its data type ",r.a.createElement("br",null),r.a.createElement("form",{onSubmit:this.onHeadersSubmit},r.a.createElement(O.a.form.Form,{ref:"form",type:n,options:t}),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Save"))),r.a.createElement("hr",null),"NOTE: This import tool does not work on all voter files, as there is no standard format. We do our best to accommodate the most common patterns. If your import doesn't work,\xa0",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/OurVoiceUSA/HelloVoter/issues/new"},"submit an issue")," and a volunteer programmer can work to fix the issue in the future. If you need the import done now, contact someone you know who's good with Microsoft\xa9 Excel or LibreOffice\xa9 and they can reformat your voter file so it works with this import tool.")}return r.a.createElement(Ee.a,{label:"Data Importa",onError:this.preProcessError,onFileLoaded:this.preProcess})}}]),t}(n.Component),ye=a(468),je=a(105),ke=a(459),Se=a(461),xe=a(32),Te=a(460),Ce=[{name:"Republican",value:400,v:89,color:"red"},{name:"Democratic",value:300,v:100},{name:"UUP",value:200,v:200},{name:"Unaffiliated",value:200,v:20}],Ae=[{name:"Republican",value:2400},{name:"Democratic",value:4567},{name:"UUP",value:1398},{name:"Unaffiliated",value:9800}],Fe=function(e){var t=e.value,a=e.percent,n=e.x,s=e.y,o=e.midAngle;return r.a.createElement("g",{transform:"translate(".concat(n,", ").concat(s,")"),textAnchor:o<-90||o>=90?"end":"start"},r.a.createElement("text",{x:0,y:0},"Count: ".concat(t)),r.a.createElement("text",{x:0,y:20},"(Percent: ".concat((100*a).toFixed(2),"%)")))},Ne=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e))).state={animation:!0},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h3",null,"Analytics"),r.a.createElement(ye.a,{width:800,height:400},r.a.createElement(je.a,null),r.a.createElement(ke.a,{data:Ce,dataKey:"value",cx:200,cy:200,startAngle:180,endAngle:0,outerRadius:80,label:!0},Ce.map(function(e,t){return r.a.createElement(Se.a,{key:"slice-".concat(t),fill:["red","blue","yellow","grey"][t]})}),r.a.createElement(xe.a,{value:"Canvassing",position:"outside"}),r.a.createElement(Te.a,{position:"outside"})),r.a.createElement(ke.a,{data:Ae,dataKey:"value",cx:600,cy:200,startAngle:180,endAngle:-180,innerRadius:60,outerRadius:80,label:Fe,paddingAngle:5,isAnimationActive:this.state.animation},Ae.map(function(e,t){return r.a.createElement(Se.a,{key:"slice-".concat(t),fill:["red","blue","yellow","grey"][t]})}),r.a.createElement(xe.a,{width:50,position:"center"},"Agreed with you"))))}}]),t}(n.Component),De=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,"Settings Component")}}]),t}(n.Component),_e=a(463),Me=a(470),Ie=function(e){function t(e){var a,n;Object(u.a)(this,t),a=Object(p.a)(this,Object(d.a)(t).call(this,e));try{n=a.props.location.pathname.split("/").pop(),y()(n)}catch(r){console.warn("Unable to extract jwt from URI: "+r),n="error"}return a.state={jwt:n},a.props.refer.setState({jwt:n}),localStorage.setItem("jwt",n),a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return"error"===this.state.jwt?r.a.createElement("div",null,"There was an error parsing the jwt"):r.a.createElement(_e.a,{render:function(){return r.a.createElement(Me.a,{to:"/"})}})}}]),t}(n.Component),Pe=a(84),Ve=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e))).componentDidMount=Object(l.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.prev=1,e.next=4,fetch("https://"+a.props.server+"/canvass/v1/dashboard",{headers:{Authorization:"Bearer "+(a.props.jwt?a.props.jwt:"of the one ring"),"Content-Type":"application/json"}});case 4:return n=e.sent,e.next=7,n.json();case 7:t=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.warn(e.t0);case 13:a.setState({cb_version:t.version?t.version:"unknown"});case 14:case"end":return e.stop()}},e,this,[[1,10]])})),a.state={cb_version:null},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",null,"HelloVoter"," version ","0.1.0"),r.a.createElement("div",null,this.state.cb_version?"canvass-broker version "+this.state.cb_version:r.a.createElement(x.a,{height:15,type:"ThreeDots"})),r.a.createElement("div",null,"\xa9 2018, Our Voice USA, a 501(c)(3) Non-Profit Organization. Not for any candidate or political party."),r.a.createElement("div",null,"This program is free software; refer to our ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/OurVoiceUSA/HelloVoter/blob/master/LICENSE"},"License")," for more details."),r.a.createElement("div",null,r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://twitter.com/OurVoiceUSA"},r.a.createElement(z,{icon:Pe.c})," @OurVoiceUSA")),r.a.createElement("div",null,r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://www.facebook.com/OurVoiceUsa"},r.a.createElement(z,{icon:Pe.a})," @OurVoiceUSA")),r.a.createElement("div",null,r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://ourvoiceusa.org/"},r.a.createElement(z,{icon:C.h})," ourvoiceusa.org")))}}]),t}(n.Component),Be=function(e){function t(e){var a;Object(u.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e))).componentDidMount=Object(l.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://"+a.state.server+"/canvass/v1/google_maps_key",{headers:{Authorization:"Bearer "+(a.state.jwt?a.state.jwt:"of the one ring"),"Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,a.setState({google_maps_key:n.google_maps_key});case 7:case"end":return e.stop()}},e,this)})),a.doSave=Object(l.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=a.refs.mainForm.getValue())){e.next=3;break}return e.abrupt("return");case 3:if(!0===t.ack){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,a.singHello(t.server);case 7:!0!==(n=e.sent).flag?console.warn(n.error?"Error":"Connection Successful",n.msg,[{text:"OK"}],{cancelable:!1}):console.warn(n);case 9:case"end":return e.stop()}},e,this)})),a.singHello=function(){var e=Object(l.a)(i.a.mark(function e(t){var n,r,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.setItem("server",t),e.prev=1,e.next=4,fetch("https://"+t+"/canvass/v1/hello",{method:"POST",headers:{Authorization:"Bearer "+(a.state.jwt?a.state.jwt:"of the one ring"),"Content-Type":"application/json"},body:JSON.stringify({longitude:-118,latitude:40})});case 4:if(n=e.sent,r=n.headers.get("x-sm-oauth-url")){e.next=8;break}return e.abrupt("return",{error:!0,msg:"Missing required header."});case 8:e.t0=n.status,e.next=200===e.t0?11:400===e.t0?12:401===e.t0?13:403===e.t0?15:16;break;case 11:return e.abrupt("break",17);case 12:return e.abrupt("return",{error:!0,msg:"The server didn't understand the request sent from this device."});case 13:return window.location.href=r+"/gm?app=HelloVoter",e.abrupt("return",{error:!1,flag:!0});case 15:return e.abrupt("return",{error:!0,msg:"We're sorry, but your request to canvass with this server has been rejected."});case 16:return e.abrupt("return",{error:!0,msg:"Unknown error connecting to server."});case 17:return e.next=19,n.json();case 19:if(s=e.sent,console.warn(s),a.setState({server:t}),localStorage.setItem("server",t),!0===s.data.ready){e.next=27;break}return e.abrupt("return",{error:!1,msg:"The server said: "+s.msg});case 27:return console.warn({server:t,dbx:null,user:a.state.user}),e.abrupt("return",{error:!1,flag:!0});case 29:e.next=35;break;case 31:return e.prev=31,e.t1=e.catch(1),console.warn("singHello: "+e.t1),e.abrupt("return",{error:!0,msg:"Unable to make a connection to target server"});case 35:case"end":return e.stop()}},e,this,[[1,31]])}));return function(t){return e.apply(this,arguments)}}();var n=k.a.parse(window.location.search);return a.state={jwt:localStorage.getItem("jwt"),server:localStorage.getItem("server"),connectForm:{server:n.server}},a.formServerItems=O.a.struct({server:O.a.String,ack:O.a.subtype(O.a.Boolean,function(e){return e})}),a.formServerOptions={fields:{server:{label:"Server Domain Name",help:"Enter the domain name of the server you wish to connect to.",error:"You must enter a domain name."},ack:{label:"Terms of Use",help:"By checking this you acknowledge that the server to which you are connecting is not affiliated with Our Voice USA and the data you send and receive is governed by that server's terms of use.",error:"You must acknowledge the terms of use."}}},a.onChange=a.onChange.bind(Object(f.a)(Object(f.a)(a))),a.doSave=a.doSave.bind(Object(f.a)(Object(f.a)(a))),a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"onChange",value:function(e){this.setState({connectForm:e})}},{key:"getName",value:function(){var e;try{e=y()(this.state.jwt).name}catch(t){console.warn(t)}return e}},{key:"_logout",value:function(){localStorage.removeItem("server"),localStorage.removeItem("jwt"),this.setState({server:null,jwt:null})}},{key:"render",value:function(){var e=this,t=this.state,a=t.server,n=t.jwt;return a?r.a.createElement(v.a,null,r.a.createElement(I,null,r.a.createElement(P,null,r.a.createElement("div",{style:{margin:10}},"Welcome, ",this.getName(),"!",r.a.createElement("br",null),"Server: ",this.state.server),r.a.createElement("hr",null),r.a.createElement(V,null,r.a.createElement(z,{icon:C.e})," ",r.a.createElement(b.a,{to:"/"},"Dashboard")),r.a.createElement(V,null,r.a.createElement(z,{icon:C.o})," ",r.a.createElement(b.a,{to:"/canvassers/"},"Canvassers")),r.a.createElement(V,null,r.a.createElement(z,{icon:C.p})," ",r.a.createElement(b.a,{to:"/teams/"},"Teams")),r.a.createElement(V,null,r.a.createElement(z,{icon:C.i})," ",r.a.createElement(b.a,{to:"/turf/"},"Turf")),r.a.createElement(V,null,r.a.createElement(z,{icon:C.c})," ",r.a.createElement(b.a,{to:"/forms/"},"Forms")),r.a.createElement(V,null,r.a.createElement(z,{icon:C.h})," ",r.a.createElement(b.a,{to:"/map/"},"Map")),r.a.createElement(V,null,r.a.createElement(z,{icon:C.g})," ",r.a.createElement(b.a,{to:"/import/"},"Import Data")),r.a.createElement(V,null,r.a.createElement(z,{icon:C.b})," ",r.a.createElement(b.a,{to:"/analytics/"},"Analytics")),r.a.createElement(V,null,r.a.createElement(z,{icon:C.d})," ",r.a.createElement(b.a,{to:"/settings/"},"Settings")),r.a.createElement(V,null,r.a.createElement(z,{icon:C.k})," ",r.a.createElement("button",{onClick:function(){return e._logout()}},"Logout")),r.a.createElement("hr",null),r.a.createElement(V,null,r.a.createElement(z,{icon:C.a})," ",r.a.createElement(b.a,{to:"/about/"},"About")),r.a.createElement(V,null,r.a.createElement(z,{icon:Pe.b})," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/OurVoiceUSA/HelloVoter/tree/master/docs/"},"Help"))),r.a.createElement(B,null,r.a.createElement(g.a,{exact:!0,path:"/",render:function(){return r.a.createElement(Q,{server:a,jwt:n})}}),r.a.createElement(g.a,{path:"/canvassers/",render:function(e){return r.a.createElement(ee,Object.assign({server:a,jwt:n},e))}}),r.a.createElement(g.a,{path:"/teams/",render:function(){return r.a.createElement(ae,{server:a,jwt:n})}}),r.a.createElement(g.a,{path:"/turf/",render:function(){return r.a.createElement(re,{server:a,jwt:n})}}),r.a.createElement(g.a,{path:"/forms/",render:function(){return r.a.createElement(pe,{server:a,jwt:n})}}),r.a.createElement(g.a,{path:"/map/",render:function(){return r.a.createElement(be,{server:a,jwt:n,apiKey:e.state.google_maps_key})}}),r.a.createElement(g.a,{path:"/import/",render:function(){return r.a.createElement(we,{server:a,jwt:n})}}),r.a.createElement(g.a,{path:"/analytics/",render:function(){return r.a.createElement(Ne,{server:a,jwt:n})}}),r.a.createElement(g.a,{path:"/settings/",render:function(){return r.a.createElement(De,{server:a,jwt:n})}}),r.a.createElement(g.a,{path:"/jwt/",render:function(t){return r.a.createElement(Ie,Object.assign({},t,{refer:e}))}}),r.a.createElement(g.a,{path:"/about/",render:function(){return r.a.createElement(Ve,{server:a,jwt:n})}})))):r.a.createElement("div",{align:"center"},r.a.createElement("br",null),r.a.createElement("strong",null,"HelloVoter"),r.a.createElement("div",null,"Version ","0.1.0"),r.a.createElement("br",null),r.a.createElement(O.a.form.Form,{ref:"mainForm",type:this.formServerItems,options:this.formServerOptions,onChange:this.onChange,value:this.state.connectForm}),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{type:"submit",className:"btn btn-primary",onClick:this.doSave},"Connect to Server")))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(Be,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[209,2,1]]]);
//# sourceMappingURL=main.a4148895.chunk.js.map